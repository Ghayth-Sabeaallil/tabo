import{j as i,u as se,r as b,L as I}from"./index-DHqvQp66.js";import{M as K,a as V,B as W,G as U,I as B,H as ce,F as le}from"./Header-DzSgBgRh.js";import{D as M,P as J,C as Y}from"./index-BpavLk4c.js";import{d as he,e as Q,A as de,u as ue,I as pe,f as re,a as fe,M as ge,S as me}from"./SyncLoader-DKWY4VgB.js";const xe=({description:a,images:e,price:t,area:s})=>i.jsxs("div",{className:"items-center justify-start border-2 border-text grid grid-cols-5 gap-2 p-2 rounded-lg bg-card hover:bg-hoverBg hover:scale-95",children:[i.jsx("div",{className:"col-span-3 font-Amiri text-xl sm:text-base md:text-2xl p-2",children:i.jsxs("div",{className:"flex flex-col items-start justify-end text-text",children:[i.jsx("p",{className:"line-clamp-2",children:a}),i.jsxs("p",{children:["المساحة: ",i.jsx("span",{className:"text-2xl",children:s})," متر مربع"]}),i.jsxs("p",{children:["السعر: ",i.jsx("span",{className:"text-2xl",children:t})," ل.س"]})]})}),i.jsx("div",{className:"flex items-center justify-center col-span-2",children:e&&i.jsx("img",{className:"rounded-lg border-4 border-text",src:e[0],alt:"primaryImage"})})]});function ye(){const a=se(),e=new URLSearchParams(a.search),t={};e.forEach((g,S)=>{t[S]=g});const[s,o]=b.useState(!1),[r,c]=b.useState(t.room?Number(t.room):0),[h,n]=b.useState(t.city?`${t.city}`:""),[d,u]=b.useState(t.type?`${t.type}`:""),[l,p]=b.useState(t.price?Number(t.price):0),[f,x]=b.useState(t.area?Number(t.area):0),y=["دمشق","حلب","حمص","اللاذقية","حماة","دير الزور","الرقة","الحسكة","طرطوس","السويداء","درعا","القامشلي","إدلب","ريف دمشق"],m=[1,2,3,4,5,6,7,8,9,10],w=[50,100,150,200,250,300,350,400,450,500,1e3],j=[40,60,90,120,150,200,250,350,500];return i.jsxs("div",{className:"text-black font-bold shadow-xl bg-bg bg-opacity-50",children:[i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 p-2",children:i.jsxs("div",{className:"flex justify-center items-center h-fit",children:[i.jsxs("div",{className:"hidden md:flex gap-4 justify-center items-center",children:[i.jsx(M,{options:y,onSelect:g=>n(String(g)),placeHolder:t.city?t.city:"المدينة"}),i.jsx(M,{options:m,onSelect:g=>c(Number(g)),placeHolder:t.room?t.room:"الحد الأقصى للغرف"}),i.jsx(M,{options:w,onSelect:g=>p(Number(g)),placeHolder:t.price?t.price:"الحد الأقصى للسعر",type:"price"}),i.jsx(M,{options:j,onSelect:g=>x(Number(g)),placeHolder:t.area?t.area:"الحد الأقصى للمساحة",type:"area"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:`bg-dropDownBg p-2 rounded-lg hover:bg-hoverBg border-2 border-text cursor-pointer flex flex-col justify-center items-center text-text font-semibold ${d==="شقة"&&"bg-hoverBg"}`,onClick:()=>u("شقة"),children:i.jsx(K,{size:30,color:"#BA9503"})}),i.jsx("div",{className:`bg-dropDownBg p-2 rounded-lg hover:bg-hoverBg border-2 border-text cursor-pointer flex flex-col justify-center items-center text-text font-semibold ${d==="أرض"&&"bg-hoverBg"}`,onClick:()=>u("أرض"),children:i.jsx(J,{size:30,color:"#BA9503"})})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:`bg-dropDownBg p-2 rounded-lg hover:bg-hoverBg border-2 border-text cursor-pointer flex flex-col justify-center items-center text-text font-semibold ${d==="محل"&&"bg-hoverBg"}`,onClick:()=>u("محل"),children:i.jsx(Y,{size:30,color:"#BA9503"})}),i.jsx("div",{className:`bg-dropDownBg p-2 rounded-lg hover:bg-hoverBg border-2 border-text cursor-pointer flex flex-col justify-center items-center text-text font-semibold ${d==="فيلا"&&"bg-hoverBg"}`,onClick:()=>u("فيلا"),children:i.jsx(V,{size:30,color:"#BA9503"})})]})]}),i.jsx(I,{to:!h&&!r&&!l&&!f&&!d?"/search":`/search?${[h?`city=${h}`:"",r?`room=${r}`:"",l?`price=${l}`:"",f?`area=${f}`:"",d?`type=${d}`:""].filter(Boolean).join("&")}`,children:i.jsx(W,{text:"بحث"})})]}),i.jsx("div",{className:"flex md:hidden",children:i.jsx("button",{onClick:()=>o(!s),className:"focus:outline-none",children:i.jsx("svg",{className:"w-10 h-10",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("path",{d:"M17.8258 5H6.17422C5.31987 5 4.85896 6.00212 5.41496 6.65079L9.75926 11.7191C9.91461 11.9004 10 12.1312 10 12.3699V17.382C10 17.7607 10.214 18.107 10.5528 18.2764L12.5528 19.2764C13.2177 19.6088 14 19.1253 14 18.382V12.3699C14 12.1312 14.0854 11.9004 14.2407 11.7191L18.585 6.65079C19.141 6.00212 18.6801 5 17.8258 5Z",stroke:"#4E342E",fill:"none",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})})]})}),s&&window.innerWidth<768&&i.jsxs("div",{className:"w-screen absolute z-50 flex flex-col justify-center items-center gap-4 bg-dropDownBg p-4",children:[i.jsxs("div",{className:"grid grid-cols-2 w-full",children:[i.jsx(M,{options:y,onSelect:g=>n(String(g)),placeHolder:t.city?t.city:"المدينة"}),i.jsx(M,{options:m,onSelect:g=>c(Number(g)),placeHolder:t.room?t.room:"الحد الأقصى للغرف"})]}),i.jsxs("div",{className:"grid grid-cols-2 w-full",children:[i.jsx(M,{options:w,onSelect:g=>p(Number(g)),placeHolder:t.price?t.price:"الحد الأقصى للسعر",type:"price"}),i.jsx(M,{options:j,onSelect:g=>x(Number(g)),placeHolder:t.area?t.area:"الحد الأقصى للمساحة",type:"area"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:`bg-dropDownBg p-2 rounded-lg hover:bg-hoverBg border-2 border-text cursor-pointer flex flex-col justify-center items-center text-text font-semibold ${d==="شقة"&&"bg-hoverBg"}`,onClick:()=>u("شقة"),children:i.jsx(K,{size:30,color:"#BA9503"})}),i.jsx("div",{className:`bg-dropDownBg p-2 rounded-lg hover:bg-hoverBg border-2 border-text cursor-pointer flex flex-col justify-center items-center text-text font-semibold ${d==="أرض"&&"bg-hoverBg"}`,onClick:()=>u("أرض"),children:i.jsx(J,{size:30,color:"#BA9503"})})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:`bg-dropDownBg p-2 rounded-lg hover:bg-hoverBg border-2 border-text cursor-pointer flex flex-col justify-center items-center text-text font-semibold ${d==="محل"&&"bg-hoverBg"}`,onClick:()=>u("محل"),children:i.jsx(Y,{size:30,color:"#BA9503"})}),i.jsx("div",{className:`bg-dropDownBg p-2 rounded-lg hover:bg-hoverBg border-2 border-text cursor-pointer flex flex-col justify-center items-center text-text font-semibold ${d==="فيلا"&&"bg-hoverBg"}`,onClick:()=>u("فيلا"),children:i.jsx(V,{size:30,color:"#BA9503"})})]})]}),i.jsx(I,{to:!h&&!r&&!l&&!f&&!d?"/search":`/search?${[h?`city=${h}`:"",r?`room=${r}`:"",l?`price=${l}`:"",f?`area=${f}`:"",d?`type=${d}`:""].filter(Boolean).join("&")}`,children:i.jsx(W,{text:"بحث"})})]})]})}function be(a){return U({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M40 48C26.7 48 16 58.7 16 72l0 48c0 13.3 10.7 24 24 24l48 0c13.3 0 24-10.7 24-24l0-48c0-13.3-10.7-24-24-24L40 48zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32l288 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L192 64zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l288 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-288 0zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l288 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-288 0zM16 232l0 48c0 13.3 10.7 24 24 24l48 0c13.3 0 24-10.7 24-24l0-48c0-13.3-10.7-24-24-24l-48 0c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24l0 48c0 13.3 10.7 24 24 24l48 0c13.3 0 24-10.7 24-24l0-48c0-13.3-10.7-24-24-24l-48 0z"},child:[]}]})(a)}function we(a){return U({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M302.8 312C334.9 271.9 408 174.6 408 120C408 53.7 354.3 0 288 0S168 53.7 168 120c0 54.6 73.1 151.9 105.2 192c7.7 9.6 22 9.6 29.6 0zM416 503l144.9-58c9.1-3.6 15.1-12.5 15.1-22.3L576 152c0-17-17.1-28.6-32.9-22.3l-116 46.4c-.5 1.2-1 2.5-1.5 3.7c-2.9 6.8-6.1 13.7-9.6 20.6L416 503zM15.1 187.3C6 191 0 199.8 0 209.6L0 480.4c0 17 17.1 28.6 32.9 22.3L160 451.8l0-251.4c-3.5-6.9-6.7-13.8-9.6-20.6c-5.6-13.2-10.4-27.4-12.8-41.5l-122.6 49zM384 255c-20.5 31.3-42.3 59.6-56.2 77c-20.5 25.6-59.1 25.6-79.6 0c-13.9-17.4-35.7-45.7-56.2-77l0 194.4 192 54.9L384 255z"},child:[]}]})(a)}async function je(){return new Promise(a=>{setTimeout(()=>{const e=he.filter(t=>t.is_active===!0);a(e)},500)})}const X=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],$=1,N=8;class R{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,s]=new Uint8Array(e,0,2);if(t!==219)throw new Error("Data does not appear to be in a KDBush format.");const o=s>>4;if(o!==$)throw new Error(`Got v${o} data when expected v${$}.`);const r=X[s&15];if(!r)throw new Error("Unrecognized array type.");const[c]=new Uint16Array(e,2,1),[h]=new Uint32Array(e,4,1);return new R(h,c,r,e)}constructor(e,t=64,s=Float64Array,o){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=s,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const r=X.indexOf(this.ArrayType),c=e*2*this.ArrayType.BYTES_PER_ELEMENT,h=e*this.IndexArrayType.BYTES_PER_ELEMENT,n=(8-h%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${s}.`);o&&o instanceof ArrayBuffer?(this.data=o,this.ids=new this.IndexArrayType(this.data,N,e),this.coords=new this.ArrayType(this.data,N+h+n,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(N+c+h+n),this.ids=new this.IndexArrayType(this.data,N,e),this.coords=new this.ArrayType(this.data,N+h+n,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,($<<4)+r]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=e,this.coords[this._pos++]=t,s}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return F(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,s,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:c,nodeSize:h}=this,n=[0,r.length-1,0],d=[];for(;n.length;){const u=n.pop()||0,l=n.pop()||0,p=n.pop()||0;if(l-p<=h){for(let m=p;m<=l;m++){const w=c[2*m],j=c[2*m+1];w>=e&&w<=s&&j>=t&&j<=o&&d.push(r[m])}continue}const f=p+l>>1,x=c[2*f],y=c[2*f+1];x>=e&&x<=s&&y>=t&&y<=o&&d.push(r[f]),(u===0?e<=x:t<=y)&&(n.push(p),n.push(f-1),n.push(1-u)),(u===0?s>=x:o>=y)&&(n.push(f+1),n.push(l),n.push(1-u))}return d}within(e,t,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:r,nodeSize:c}=this,h=[0,o.length-1,0],n=[],d=s*s;for(;h.length;){const u=h.pop()||0,l=h.pop()||0,p=h.pop()||0;if(l-p<=c){for(let m=p;m<=l;m++)q(r[2*m],r[2*m+1],e,t)<=d&&n.push(o[m]);continue}const f=p+l>>1,x=r[2*f],y=r[2*f+1];q(x,y,e,t)<=d&&n.push(o[f]),(u===0?e-s<=x:t-s<=y)&&(h.push(p),h.push(f-1),h.push(1-u)),(u===0?e+s>=x:t+s>=y)&&(h.push(f+1),h.push(l),h.push(1-u))}return n}}function F(a,e,t,s,o,r){if(o-s<=t)return;const c=s+o>>1;oe(a,e,c,s,o,r),F(a,e,t,s,c-1,1-r),F(a,e,t,c+1,o,1-r)}function oe(a,e,t,s,o,r){for(;o>s;){if(o-s>600){const d=o-s+1,u=t-s+1,l=Math.log(d),p=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*p*(d-p)/d)*(u-d/2<0?-1:1),x=Math.max(s,Math.floor(t-u*p/d+f)),y=Math.min(o,Math.floor(t+(d-u)*p/d+f));oe(a,e,t,x,y,r)}const c=e[2*t+r];let h=s,n=o;for(_(a,e,s,t),e[2*o+r]>c&&_(a,e,s,o);h<n;){for(_(a,e,h,n),h++,n--;e[2*h+r]<c;)h++;for(;e[2*n+r]>c;)n--}e[2*s+r]===c?_(a,e,s,n):(n++,_(a,e,n,o)),n<=t&&(s=n+1),t<=n&&(o=n-1)}}function _(a,e,t,s){z(a,t,s),z(e,2*t,2*s),z(e,2*t+1,2*s+1)}function z(a,e,t){const s=a[e];a[e]=a[t],a[t]=s}function q(a,e,t,s){const o=a-t,r=e-s;return o*o+r*r}const ve={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:a=>a},ee=Math.fround||(a=>e=>(a[0]=+e,a[0]))(new Float32Array(1)),E=2,C=3,D=4,k=5,ne=6;class Me{constructor(e){this.options=Object.assign(Object.create(ve),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:s,maxZoom:o}=this.options;t&&console.time("total time");const r=`prepare ${e.length} points`;t&&console.time(r),this.points=e;const c=[];for(let n=0;n<e.length;n++){const d=e[n];if(!d.geometry)continue;const[u,l]=d.geometry.coordinates,p=ee(P(u)),f=ee(O(l));c.push(p,f,1/0,n,-1,1),this.options.reduce&&c.push(0)}let h=this.trees[o+1]=this._createTree(c);t&&console.timeEnd(r);for(let n=o;n>=s;n--){const d=+Date.now();h=this.trees[n]=this._createTree(this._cluster(h,n)),t&&console.log("z%d: %d clusters in %dms",n,h.numItems,+Date.now()-d)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let s=((e[0]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,e[1]));let r=e[2]===180?180:((e[2]+180)%360+360)%360-180;const c=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)s=-180,r=180;else if(s>r){const l=this.getClusters([s,o,180,c],t),p=this.getClusters([-180,o,r,c],t);return l.concat(p)}const h=this.trees[this._limitZoom(t)],n=h.range(P(s),O(c),P(r),O(o)),d=h.data,u=[];for(const l of n){const p=this.stride*l;u.push(d[p+k]>1?te(d,p,this.clusterProps):this.points[d[p+C]])}return u}getChildren(e){const t=this._getOriginId(e),s=this._getOriginZoom(e),o="No cluster with the specified id.",r=this.trees[s];if(!r)throw new Error(o);const c=r.data;if(t*this.stride>=c.length)throw new Error(o);const h=this.options.radius/(this.options.extent*Math.pow(2,s-1)),n=c[t*this.stride],d=c[t*this.stride+1],u=r.within(n,d,h),l=[];for(const p of u){const f=p*this.stride;c[f+D]===e&&l.push(c[f+k]>1?te(c,f,this.clusterProps):this.points[c[f+C]])}if(l.length===0)throw new Error(o);return l}getLeaves(e,t,s){t=t||10,s=s||0;const o=[];return this._appendLeaves(o,e,t,s,0),o}getTile(e,t,s){const o=this.trees[this._limitZoom(e)],r=Math.pow(2,e),{extent:c,radius:h}=this.options,n=h/c,d=(s-n)/r,u=(s+1+n)/r,l={features:[]};return this._addTileFeatures(o.range((t-n)/r,d,(t+1+n)/r,u),o.data,t,s,r,l),t===0&&this._addTileFeatures(o.range(1-n/r,d,1,u),o.data,r,s,r,l),t===r-1&&this._addTileFeatures(o.range(0,d,n/r,u),o.data,-1,s,r,l),l.features.length?l:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const s=this.getChildren(e);if(t++,s.length!==1)break;e=s[0].properties.cluster_id}return t}_appendLeaves(e,t,s,o,r){const c=this.getChildren(t);for(const h of c){const n=h.properties;if(n&&n.cluster?r+n.point_count<=o?r+=n.point_count:r=this._appendLeaves(e,n.cluster_id,s,o,r):r<o?r++:e.push(h),e.length===s)break}return r}_createTree(e){const t=new R(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let s=0;s<e.length;s+=this.stride)t.add(e[s],e[s+1]);return t.finish(),t.data=e,t}_addTileFeatures(e,t,s,o,r,c){for(const h of e){const n=h*this.stride,d=t[n+k]>1;let u,l,p;if(d)u=ie(t,n,this.clusterProps),l=t[n],p=t[n+1];else{const y=this.points[t[n+C]];u=y.properties;const[m,w]=y.geometry.coordinates;l=P(m),p=O(w)}const f={type:1,geometry:[[Math.round(this.options.extent*(l*r-s)),Math.round(this.options.extent*(p*r-o))]],tags:u};let x;d||this.options.generateId?x=t[n+C]:x=this.points[t[n+C]].id,x!==void 0&&(f.id=x),c.features.push(f)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:s,extent:o,reduce:r,minPoints:c}=this.options,h=s/(o*Math.pow(2,t)),n=e.data,d=[],u=this.stride;for(let l=0;l<n.length;l+=u){if(n[l+E]<=t)continue;n[l+E]=t;const p=n[l],f=n[l+1],x=e.within(n[l],n[l+1],h),y=n[l+k];let m=y;for(const w of x){const j=w*u;n[j+E]>t&&(m+=n[j+k])}if(m>y&&m>=c){let w=p*y,j=f*y,g,S=-1;const T=((l/u|0)<<5)+(t+1)+this.points.length;for(const ae of x){const A=ae*u;if(n[A+E]<=t)continue;n[A+E]=t;const G=n[A+k];w+=n[A]*G,j+=n[A+1]*G,n[A+D]=T,r&&(g||(g=this._map(n,l,!0),S=this.clusterProps.length,this.clusterProps.push(g)),r(g,this._map(n,A)))}n[l+D]=T,d.push(w/m,j/m,1/0,T,-1,m),r&&d.push(S)}else{for(let w=0;w<u;w++)d.push(n[l+w]);if(m>1)for(const w of x){const j=w*u;if(!(n[j+E]<=t)){n[j+E]=t;for(let g=0;g<u;g++)d.push(n[j+g])}}}}return d}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,s){if(e[t+k]>1){const c=this.clusterProps[e[t+ne]];return s?Object.assign({},c):c}const o=this.points[e[t+C]].properties,r=this.options.map(o);return s&&r===o?Object.assign({},r):r}}function te(a,e,t){return{type:"Feature",id:a[e+C],properties:ie(a,e,t),geometry:{type:"Point",coordinates:[ke(a[e]),Ce(a[e+1])]}}}function ie(a,e,t){const s=a[e+k],o=s>=1e4?`${Math.round(s/1e3)}k`:s>=1e3?`${Math.round(s/100)/10}k`:s,r=a[e+ne],c=r===-1?{}:Object.assign({},t[r]);return Object.assign(c,{cluster:!0,cluster_id:a[e+C],point_count:s,point_count_abbreviated:o})}function P(a){return a/360+.5}function O(a){const e=Math.sin(a*Math.PI/180),t=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return t<0?0:t>1?1:t}function ke(a){return(a-.5)*360}function Ce(a){const e=(180-a*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Ae(a,e){var t={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&e.indexOf(s)<0&&(t[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(a);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(a,s[o])&&(t[s[o]]=a[s[o]]);return t}class v{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,t){this.isAdvancedMarker(e)?e.map=t:e.setMap(t)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class Z{constructor({markers:e,position:t}){this.markers=e,t&&(t instanceof google.maps.LatLng?this._position=t:this._position=new google.maps.LatLng(t))}get bounds(){if(this.markers.length===0&&!this._position)return;const e=new google.maps.LatLngBounds(this._position,this._position);for(const t of this.markers)e.extend(v.getPosition(t));return e}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>v.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(v.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class Ee{constructor({maxZoom:e=16}){this.maxZoom=e}noop({markers:e}){return Ne(e)}}const Ne=a=>a.map(t=>new Z({position:v.getPosition(t),markers:[t]}));class _e extends Ee{constructor(e){var{maxZoom:t,radius:s=60}=e,o=Ae(e,["maxZoom","radius"]);super({maxZoom:t}),this.state={zoom:-1},this.superCluster=new Me(Object.assign({maxZoom:this.maxZoom,radius:s},o))}calculate(e){let t=!1;const s={zoom:e.map.getZoom()};if(!Q(e.markers,this.markers)){t=!0,this.markers=[...e.markers];const o=this.markers.map(r=>{const c=v.getPosition(r);return{type:"Feature",geometry:{type:"Point",coordinates:[c.lng(),c.lat()]},properties:{marker:r}}});this.superCluster.load(o)}return t||(this.state.zoom<=this.maxZoom||s.zoom<=this.maxZoom)&&(t=!Q(this.state,s)),this.state=s,t&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:t}}cluster({map:e}){return this.superCluster.getClusters([-180,-90,180,90],Math.round(e.getZoom())).map(t=>this.transformCluster(t))}transformCluster({geometry:{coordinates:[e,t]},properties:s}){if(s.cluster)return new Z({markers:this.superCluster.getLeaves(s.cluster_id,1/0).map(r=>r.properties.marker),position:{lat:t,lng:e}});const o=s.marker;return new Z({markers:[o],position:v.getPosition(o)})}}class Le{constructor(e,t){this.markers={sum:e.length};const s=t.map(r=>r.count),o=s.reduce((r,c)=>r+c,0);this.clusters={count:t.length,markers:{mean:o/t.length,sum:o,min:Math.min(...s),max:Math.max(...s)}}}}class Se{render({count:e,position:t},s,o){const c=`<svg fill="${e>Math.max(10,s.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">${e}</text>
</svg>`,h=`Cluster of ${e} markers`,n=Number(google.maps.Marker.MAX_ZINDEX)+e;if(v.isAdvancedMarkerAvailable(o)){const l=new DOMParser().parseFromString(c,"image/svg+xml").documentElement;l.setAttribute("transform","translate(0 25)");const p={map:o,position:t,zIndex:n,title:h,content:l};return new google.maps.marker.AdvancedMarkerElement(p)}const d={position:t,zIndex:n,title:h,icon:{url:`data:image/svg+xml;base64,${btoa(c)}`,anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(d)}}function Be(a,e){for(let t in e.prototype)a.prototype[t]=e.prototype[t]}class H{constructor(){Be(H,google.maps.OverlayView)}}var L;(function(a){a.CLUSTERING_BEGIN="clusteringbegin",a.CLUSTERING_END="clusteringend",a.CLUSTER_CLICK="click"})(L||(L={}));const Pe=(a,e,t)=>{t.fitBounds(e.bounds)};class Oe extends H{constructor({map:e,markers:t=[],algorithmOptions:s={},algorithm:o=new _e(s),renderer:r=new Se,onClusterClick:c=Pe}){super(),this.markers=[...t],this.clusters=[],this.algorithm=o,this.renderer=r,this.onClusterClick=c,e&&this.setMap(e)}addMarker(e,t){this.markers.includes(e)||(this.markers.push(e),t||this.render())}addMarkers(e,t){e.forEach(s=>{this.addMarker(s,!0)}),t||this.render()}removeMarker(e,t){const s=this.markers.indexOf(e);return s===-1?!1:(v.setMap(e,null),this.markers.splice(s,1),t||this.render(),!0)}removeMarkers(e,t){let s=!1;return e.forEach(o=>{s=this.removeMarker(o,!0)||s}),s&&!t&&this.render(),s}clearMarkers(e){this.markers.length=0,e||this.render()}render(){const e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,L.CLUSTERING_BEGIN,this);const{clusters:t,changed:s}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(s||s==null){const o=new Set;for(const c of t)c.markers.length==1&&o.add(c.markers[0]);const r=[];for(const c of this.clusters)c.marker!=null&&(c.markers.length==1?o.has(c.marker)||v.setMap(c.marker,null):r.push(c.marker));this.clusters=t,this.renderClusters(),requestAnimationFrame(()=>r.forEach(c=>v.setMap(c,null)))}google.maps.event.trigger(this,L.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>v.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){const e=new Le(this.markers,this.clusters),t=this.getMap();this.clusters.forEach(s=>{s.markers.length===1?s.marker=s.markers[0]:(s.marker=this.renderer.render(s,e,t),s.markers.forEach(o=>v.setMap(o,null)),this.onClusterClick&&s.marker.addListener("click",o=>{google.maps.event.trigger(this,L.CLUSTER_CLICK,s),this.onClusterClick(o,s,t)})),v.setMap(s.marker,t)})}}const Ie=a=>{const{item:e,onClick:t,setMarkerRef:s}=a,o=b.useCallback(()=>t(e),[t,e]),r=b.useCallback(c=>s(c,e.id),[s,e.id]);return i.jsxs(de,{position:e.location,ref:r,onClick:o,children:[e.type==="شقة"&&i.jsx(B,{color:"orange",size:30}),e.type==="أرض"&&i.jsx(B,{color:"green",size:30}),e.type==="فيلا"&&i.jsx(B,{color:"red",size:30}),e.type==="محل"&&i.jsx(B,{color:"blue",size:30})]})};function Te(a){return U({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm75.31 260.69a16 16 0 1 1-22.62 22.62L256 278.63l-52.69 52.68a16 16 0 0 1-22.62-22.62L233.37 256l-52.68-52.69a16 16 0 0 1 22.62-22.62L256 233.37l52.69-52.68a16 16 0 0 1 22.62 22.62L278.63 256z"},child:[]}]})(a)}const $e=({items:a})=>{const[e,t]=b.useState({}),[s,o]=b.useState(null),r=b.useMemo(()=>a&&s?a.find(l=>l.id===s):null,[a,s]),c=ue(),h=b.useMemo(()=>c?new Oe({map:c}):null,[c]);b.useEffect(()=>{h&&(h.clearMarkers(),h.addMarkers(Object.values(e)))},[h,e]);const n=b.useCallback((l,p)=>{t(f=>{if(l&&f[p]||!l&&!f[p])return f;if(l)return{...f,[p]:l};{const{[p]:x,...y}=f;return y}})},[]),d=b.useCallback(()=>{o(null)},[]),u=b.useCallback(l=>{o(l.id)},[]);return i.jsxs(i.Fragment,{children:[a.map(l=>i.jsx(Ie,{item:l,onClick:u,setMarkerRef:n},l.id)),s&&i.jsx(pe,{headerDisabled:!0,anchor:e[s],onCloseClick:d,children:i.jsxs("div",{className:"flex flex-col justify-center w-40 gap-2",children:[i.jsx(Te,{onClick:d,className:"absolute top-4 right-4 cursor-pointer",color:"white",size:20}),i.jsx("img",{className:"border-2 border-black rounded",src:r==null?void 0:r.images[0],alt:""}),i.jsx("p",{className:"text-[#BA9503] text-base font-bold font-Amiri line-clamp-3",children:r==null?void 0:r.description}),i.jsxs("p",{className:"text-[#0D5C02] text-base font-bold font-Amiri",children:[re(r==null?void 0:r.price)," ل.س"]}),i.jsx(I,{className:"text-blue text-sm font-bold font-Amiri underline-offset-1 text-blue-700",to:`/item?id=${r==null?void 0:r.id}`,children:"لمزيد من التفاصيل ..."})]})})]})},ze=()=>{const[a,e]=b.useState("list"),[t,s]=b.useState(),o=se();return b.useEffect(()=>{(async()=>{const h=window.location.pathname,n=window.location.search;h==="/search"&&!n&&je().then(d=>s(d))})()},[o]),i.jsxs(i.Fragment,{children:[i.jsx(ye,{}),i.jsxs("div",{className:"flex gap-4 bg-bg bg-opacity-50 p-1 pr-5",children:[i.jsx("div",{className:"cursor-pointer",onClick:()=>e("map"),children:i.jsx(we,{size:20,color:"#4E342E"})}),i.jsx("div",{className:"cursor-pointer",onClick:()=>e("list"),children:i.jsx(be,{size:20,color:"#4E342E"})})]}),a==="list"&&(t==null?void 0:t.length)>0?i.jsx("main",{className:"flex flex-col overflow-y-auto h-full p-3 gap-2 sm:grid sm:grid-cols-2 lg:grid-cols-3 bg-bg bg-opacity-50",children:t.map(c=>i.jsx(I,{to:`/item?id=${c.id}`,children:i.jsx(xe,{description:c.description,images:c.images,price:re(c.price),area:c.area},c.id)},c.id))}):a==="map"&&(t==null?void 0:t.length)>0?i.jsx("div",{className:"bg-bg flex justify-center items-center h-full text-3xl p-1",children:i.jsx(fe,{apiKey:"AIzaSyB8K_CEjl8QKs99VLJZfTXh0rl17-lgoug",onLoad:()=>console.log("Maps API has loaded."),children:i.jsx(ge,{mapId:"bf51a910020fa25a",defaultZoom:7,defaultCenter:{lat:35.0271824852867,lng:38.51505715398323},gestureHandling:"greedy",mapTypeId:"roadmap",disableDefaultUI:!1,colorScheme:"FOLLOW_SYSTEM",children:i.jsx($e,{items:t})})})}):i.jsx("div",{className:"flex justify-center items-center h-full bg-bg bg-opacity-50",children:i.jsx(me,{color:"#4E342E",loading:!0,size:20,"aria-label":"Loading Spinner","data-testid":"SyncLoader"})})]})};function Re(){return document.title="طابو",i.jsxs(i.Fragment,{children:[i.jsx(ce,{}),i.jsx(ze,{}),i.jsx(le,{})]})}export{Re as default};
